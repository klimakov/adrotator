# Идеи киллер-фич для AdRotator

Фичи, которые реально могут помочь зарабатывать или удерживать клиентов. Без «честности ради честности».

---

## 1. **A/B тест креативов с авто-перекосом трафика**

**Суть:** В одной кампании несколько баннеров. Система сама считает CTR по каждому и постепенно даёт больше показов тому, у кого CTR выше (multi-armed bandit или простой перекос по весам раз в N часов).

**Кому выгода:** Рекламодатель получает лучший результат при том же бюджете. Паблишер не теряет — показов столько же, просто чаще показывается то, во что кликают.

**Реализация:** Уже есть веса у креативов. Добавить: джоб раз в час пересчитывает CTR по креативам за последние 24–48 ч и обновляет `weight` (или отдельное поле `effective_weight`) в сторону лучших. Ротация уже взвешенная — остаётся только подкручивать веса по данным.

**Сложность:** низкая.

---

## 2. **Гарантированный fill rate / fallback-цепочка**

**Суть:** У площадки можно задать несколько «источников»: сначала свои кампании AdRotator, если нет подходящего баннера — запрос во внешний блок (например, другой ad server или статичный backup-баннер). В отчёте: «fill rate 98%» — реклама показана в 98% запросов.

**Кому выгода:** Паблишер не теряет деньги на пустых слотах. Можно продавать «мы гарантируем fill 95%» как премиум.

**Реализация:** В конфиге площадки — опциональный URL fallback. В `/serve/:zoneKey`: если своих креативов 0 или ни один не подошёл — 302 редирект на fallback URL с параметрами (zone, size) или отдать 204 и в SDK по 204 подставлять свой статичный блок. Плюс счётчик запросов без выдачи для расчёта fill rate.

**Сложность:** средняя.

---

## 3. **Revenue share и «кабинет паблишера»**

**Суть:** Паблишер видит свой доход по площадкам (показы × CPM или фикс за слот), вывод средств, история. Рекламодатель пополняет баланс, списание за показы/клики.

**Кому выгода:** Паблишеры приходят ради прозрачного заработка. Платформа зарабатывает на марже (разница между то, что платит рекламодатель, и то, что получает паблишер) или на % от оборота.

**Реализация:** Бюджеты кампаний уже есть. Нужны: балансы, тарифы (CPM/CPC по кампании или по площадке), списание при показе/клике, начисление паблишеру, роли (advertiser / publisher / admin), отдельные входы или те же юзеры с разными «кабинетами».

**Сложность:** высокая.

---

## 4. **Простые таргетинги: гео, устройство, время**

**Суть:** В кампании можно включить ограничения: показывать только из РФ, только mobile, только с 9 до 21. Так рекламодатель меньше платит за «нецелевой» трафик.

**Кому выгода:** Рекламодатель готов платить больше за релевантность. Паблишер может продавать «таргетированные» слоты дороже.

**Реализация:** В запросе баннера (или в трекинге) передаём User-Agent, IP (для гео по GeoIP), время. В БД у кампании — JSON или поля: countries[], device_type (desktop/mobile/any), time_slot. В `/serve` при выборе креативов фильтровать кампании по этим правилам. GeoIP — библиотека или внешний сервис.

**Сложность:** средняя.

---

## 5. **Единый тег «один скрипт на весь сайт»**

**Суть:** Паблишер вставляет один скрипт без указания зон. SDK сам находит на странице «места под рекламу» (например контейнеры с data-slot или автоматически по размеру пустых блоков) и запрашивает баннеры под подходящие размеры. Зоны создаются в админке «по факту» или по правилам (например «любой 300x250» = одна зона).

**Кому выгода:** Паблишеру не нужно вручную прописывать каждую зону. Меньше барьер входа — быстрее подключаются сайты.

**Реализация:** SDK при загрузке сканирует страницу (или один общий контейнер), определяет размеры слотов, для каждого размера дергает `/serve` с виртуальным zone_key (например `auto-300x250`) или сервер отдаёт баннер по размеру без привязки к конкретной зоне. В админке — «автозоны» по размеру и, опционально, по домену.

**Сложность:** средняя.

---

## 6. **Лимиты по показам на пользователя (frequency cap)**

**Суть:** В кампании задаётся «не больше N показов на одного юзера в день». По cookie или по хэшу IP+User-Agent считаем, сколько раз уже показывали, и не отдаём баннер сверх лимита.

**Кому выгода:** Рекламодатель не переплачивает за одного и того же юзера. Меньше раздражения у пользователя — чуть выше качество инвентаря.

**Реализация:** При выдаче баннера отдаём cookie (или читаем свой). В Redis ключ `fcap:campaign_id:user_id` с инкрементом и TTL 24h. В `/serve` перед выбором креатива проверяем лимит по кампании; если лимит достигнут, креативы этой кампании не рассматриваем.

**Сложность:** низкая–средняя.

---

## 7. **Быстрый «маркетплейс» креативов**

**Суть:** Рекламодатель загружает баннер один раз. Паблишеры в каталоге видят «доступные креативы» по размерам и темам и подключают их к своим площадкам. Или наоборот: рекламодатель выбирает площадки/сайты из каталога. Деньги идут через платформу.

**Кому выгода:** Больше ликвидности: рекламодателям проще найти инвентарь, паблишерам — рекламу. Платформа зарабатывает на сделках.

**Реализация:** Публичный каталог (креативы с галочкой «доступен в маркетплейс»), поиск по размеру/категории, «подключить к моей площадке» = создание размещения и привязка. Плюс биллинг и роли из п.3.

**Сложность:** высокая.

---

## 8. **Webhook при клике / конверсии**

**Суть:** В настройках кампании или креатива — URL. При клике (или при переходе на целевую с пикселем конверсии) платформа шлёт POST на этот URL с данными (campaign_id, creative_id, click_id, ip, user_agent, время). Рекламодатель стыкует с своей аналитикой или CRM.

**Кому выгода:** Рекламодателям проще считать конверсии и оптимизировать. Повышает доверие и «профессиональность» платформы.

**Реализация:** В БД поле `webhook_url` у кампании или креатива. В `/track/click` после записи клика — асинхронный POST (fetch в фоне) на webhook_url с JSON. Опционально: отдельный эндпоинт «конверсия» с передачей click_id.

**Сложность:** низкая.

---

## 9. **Отчёты и экспорт (CSV/Excel за период)**

**Суть:** В админке кнопка «Скачать отчёт»: показы, клики, видимые, CTR, viewability по кампаниям/площадкам за выбранные даты. CSV или XLSX.

**Кому выгода:** Рекламодатели и паблишеры закрывают отчётность без ручного копирования. Меньше «пришлите выгрузку» в поддержку.

**Реализация:** Эндпоинт `/stats/export?from=&to=&group=campaigns|campaigns` возвращает CSV или генерирует XLSX (библиотека на бэкенде). В админке — форма дат + кнопка, скачивание по ссылке или через fetch.

**Сложность:** низкая.

---

## 10. **Превью и «песочница» вставки кода**

**Суть:** В форме площадки не только «скопировать код», но и кнопка «Посмотреть, как будет выглядеть»: открывается окно/страница с уже вставленным баннером в нужном размере, без публикации на реальном сайте.

**Кому выгода:** Паблишер сразу видит, как баннер встанет на страницу. Меньше ошибок и отказов от интеграции.

**Реализация:** Отдельная страница или iframe с параметрами zone_key и размером; на ней только div + SDK. В админке кнопка «Открыть превью» = новая вкладка на эту страницу.

**Сложность:** низкая.

---

## Приоритет по «заработку vs усилия»

| Фича | Помогает зарабатывать | Усилия |
|------|------------------------|--------|
| A/B с авто-перекосом | Да (лучший CTR → довольный рекламодатель) | Низкие |
| Fill rate / fallback | Да (меньше пустых слотов у паблишера) | Средние |
| Frequency cap | Да (рекламодатель не переплачивает) | Низкие |
| Webhook клика | Доверие, интеграции | Низкие |
| Экспорт отчётов | Удобство, меньше рутины | Низкие |
| Превью вставки | Меньше трения при подключении | Низкие |
| Таргетинг гео/устройство/время | Да (можно брать доплату за таргетинг) | Средние |
| Единый тег на весь сайт | Да (быстрее подключаются паблишеры) | Средние |
| Revenue share + кабинеты | Да (основа монетизации платформы) | Высокие |
| Маркетплейс | Да (ликвидность, комиссия) | Высокие |

Для быстрого «киллера» с минимальным кодом логично начать с **A/B с перекосом по CTR**, **frequency cap** и **webhook при клике** — всё упирается в текущую модель кампаний/креативов и трекинг.
